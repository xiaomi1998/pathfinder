# ==========================================
# Pathfinder 缩小版 - 环境配置模板
# ==========================================
# 复制此文件为 .env.mini 并填入实际值

# ==========================================
# 基础应用配置
# ==========================================
NODE_ENV=production
APP_NAME=Pathfinder Mini
APP_VERSION=1.0.0
TZ=Asia/Shanghai

# 服务端口配置
BACKEND_PORT=3000
FRONTEND_PORT=80
PROMETHEUS_PORT=9090
LOKI_PORT=3100

# ==========================================
# 数据库配置 - PostgreSQL
# ==========================================
POSTGRES_DB=pathfinder_db
POSTGRES_USER=pathfinder_app
POSTGRES_PASSWORD=your-super-secure-postgres-password-here
POSTGRES_PORT=5432

# 数据库连接池配置
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_POOL_TIMEOUT=20000
DB_CONNECTION_TIMEOUT=60000

# 数据库URL (自动生成，一般不需要修改)
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}?schema=public&connection_limit=10&pool_timeout=20

# ==========================================
# Redis 缓存配置
# ==========================================
REDIS_PASSWORD=your-super-secure-redis-password-here
REDIS_PORT=6379
REDIS_URL=redis://:${REDIS_PASSWORD}@redis:6379

# Redis 内存配置
REDIS_MAX_MEMORY=128mb
REDIS_MAX_MEMORY_POLICY=allkeys-lru

# ==========================================
# JWT 安全配置
# ==========================================
JWT_SECRET=your-super-secret-jwt-key-minimum-32-characters-long
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d
BCRYPT_ROUNDS=12

# ==========================================
# AI 服务配置
# ==========================================
# Google Gemini API
GEMINI_API_KEY=your-gemini-api-key-here
AI_MODEL=gemini-pro
AI_TEMPERATURE=0.7
AI_MAX_TOKENS=1000

# OpenAI API (备选)
OPENAI_API_KEY=your-openai-api-key-here
OPENAI_MODEL=gpt-3.5-turbo

# AI 功能开关
ENABLE_AI_FEATURES=true
AI_RATE_LIMIT=10

# ==========================================
# 前端配置
# ==========================================
DOMAIN_NAME=localhost
API_BASE_URL=http://localhost:3000
WS_BASE_URL=ws://localhost:3000

# CORS 配置
CORS_ORIGIN=http://localhost,https://localhost
CORS_CREDENTIALS=true

# ==========================================
# 文件上传配置
# ==========================================
MAX_FILE_SIZE=10485760
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/webp,text/csv,application/json
UPLOAD_PATH=./uploads

# ==========================================
# 安全和限流配置
# ==========================================
# 请求限流
RATE_LIMIT_WINDOW=900000
RATE_LIMIT_MAX=100
RATE_LIMIT_SKIP_SUCCESSFUL=true

# 安全头配置
HELMET_CSP_ENABLED=true
HELMET_HSTS_ENABLED=true

# 会话配置
SESSION_SECRET=your-session-secret-key-here
SESSION_MAX_AGE=86400000
SESSION_SECURE=false

# ==========================================
# 日志配置
# ==========================================
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE_ENABLED=true
LOG_CONSOLE_ENABLED=true
LOG_MAX_FILES=7
LOG_MAX_SIZE=10m

# 日志输出目录
LOG_DIR=./logs

# ==========================================
# 监控配置
# ==========================================
# Prometheus
PROMETHEUS_ENABLED=false
METRICS_ENDPOINT=/metrics
METRICS_BASIC_AUTH=false

# 健康检查
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_ENDPOINT=/api/health

# ==========================================
# 数据库管理工具配置 (开发环境)
# ==========================================
PGADMIN_EMAIL=admin@pathfinder.local
PGADMIN_PASSWORD=admin123456
PGADMIN_PORT=5050

# Redis 管理工具
REDIS_UI_USER=admin
REDIS_UI_PASSWORD=admin123456
REDIS_UI_PORT=8081

# ==========================================
# 备份配置
# ==========================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"
BACKUP_RETENTION_DAYS=7
BACKUP_PATH=./backups

# ==========================================
# 邮件配置 (可选)
# ==========================================
MAIL_ENABLED=false
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
MAIL_FROM=noreply@pathfinder.local

# ==========================================
# 缓存配置
# ==========================================
CACHE_TTL=3600
CACHE_MAX_SIZE=100
CACHE_ENABLED=true

# ==========================================
# 数据分析配置
# ==========================================
ANALYTICS_BATCH_SIZE=1000
ANALYTICS_PROCESS_INTERVAL=300000
ANALYTICS_RETENTION_DAYS=90

# ==========================================
# 定时任务配置
# ==========================================
SCHEDULER_ENABLED=true
CLEANUP_INTERVAL="0 3 * * *"
ANALYTICS_CALCULATION_INTERVAL="*/15 * * * *"
BACKUP_INTERVAL="0 2 * * *"

# ==========================================
# 开发和调试配置
# ==========================================
DEBUG=false
DEBUG_SQL=false
ENABLE_REQUEST_LOGGING=true
ENABLE_CORS_DEBUG=false

# 开发工具
HOT_RELOAD=false
WATCH_FILES=false

# ==========================================
# 生产环境优化配置
# ==========================================
# 进程管理
PM2_ENABLED=false
PM2_INSTANCES=max
PM2_MAX_MEMORY=512M

# 性能优化
ENABLE_COMPRESSION=true
ENABLE_STATIC_CACHE=true
STATIC_CACHE_MAX_AGE=86400

# SSL/TLS (反向代理配置)
SSL_ENABLED=false
SSL_CERT_PATH=./ssl/cert.pem
SSL_KEY_PATH=./ssl/key.pem

# ==========================================
# 环境特定配置
# ==========================================
# 开发环境标识
IS_DEVELOPMENT=false
IS_TESTING=false
IS_PRODUCTION=true

# 功能开关
ENABLE_SWAGGER=false
ENABLE_GRAPHQL_PLAYGROUND=false
ENABLE_DEBUG_ENDPOINTS=false

# ==========================================
# 外部服务集成 (可选)
# ==========================================
# Sentry 错误追踪
SENTRY_ENABLED=false
SENTRY_DSN=your-sentry-dsn-here
SENTRY_ENVIRONMENT=production

# Google Analytics
GA_TRACKING_ID=your-ga-tracking-id-here
GA_ENABLED=false

# ==========================================
# 资源限制
# ==========================================
MAX_CONCURRENT_REQUESTS=100
MAX_REQUEST_SIZE=50mb
MAX_JSON_SIZE=10mb
MAX_URL_LENGTH=2048

# 数据库查询限制
MAX_QUERY_TIMEOUT=30000
MAX_QUERY_ROWS=10000

# ==========================================
# 自定义配置
# ==========================================
# 业务逻辑配置
MAX_FUNNELS_PER_USER=10
MAX_NODES_PER_FUNNEL=20
DEFAULT_FUNNEL_TEMPLATE=basic_sales_funnel

# 数据保留策略
DATA_RETENTION_DAYS=365
INACTIVE_USER_CLEANUP_DAYS=180
TEMP_FILE_CLEANUP_HOURS=24

# ==========================================
# 注意事项
# ==========================================
# 1. 生产环境中务必更改所有密码和密钥
# 2. 确保数据库和 Redis 密码足够复杂
# 3. JWT_SECRET 至少 32 个字符
# 4. 根据服务器资源调整内存和连接数限制
# 5. 启用 SSL 时确保证书路径正确
# 6. 监控配置根据需要启用
# 7. 邮件配置仅在需要发送通知时启用