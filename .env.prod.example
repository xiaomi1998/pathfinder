# Pathfinder Production Environment Configuration Example
# Copy this file to .env.prod and fill in your actual values

# =============================================================================
# Basic Configuration
# =============================================================================
VERSION=1.0.0
APP_NAME=Pathfinder
NODE_ENV=production
PORT=3000
HOST=0.0.0.0
INSTANCE_ID=1

# Domain and URL Configuration
DOMAIN_NAME=yourdomain.com
API_BASE_URL=https://yourdomain.com/api
BASE_URL=https://yourdomain.com

# =============================================================================
# Database Configuration - PostgreSQL
# =============================================================================
DB_HOST=postgres-primary
DB_PORT=5432
DB_NAME=pathfinder_prod
DB_USER=pathfinder_app
DB_PASSWORD=your-secure-postgres-password-min-32-chars-here
DB_SSL_MODE=require
DB_MAX_CONNECTIONS=20
DB_IDLE_TIMEOUT=30000
DB_CONNECTION_TIMEOUT=2000

# Database Pool Configuration
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_POOL_IDLE=10000

# Prisma Database URL (auto-generated from above values)
DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}?schema=public&sslmode=require

# Database Replica (Read-only)
DB_REPLICA_HOST=postgres-replica
DB_REPLICA_PORT=5432
DB_REPLICA_URL=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_REPLICA_HOST}:${DB_REPLICA_PORT}/${DB_NAME}?schema=public&sslmode=require

# =============================================================================
# Redis Configuration - Cache & Sessions
# =============================================================================
REDIS_HOST=redis-master
REDIS_PORT=6379
REDIS_PASSWORD=your-secure-redis-password-min-32-chars-here
REDIS_DB=0
REDIS_TTL=3600
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY=100

# Redis URL (auto-generated)
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# Redis Sentinel (if using high availability)
REDIS_SENTINEL_MASTER_NAME=mymaster
REDIS_SENTINEL_HOSTS=redis-sentinel-1:26379,redis-sentinel-2:26379,redis-sentinel-3:26379

# =============================================================================
# Security Configuration
# =============================================================================
# JWT Configuration (Generate with: openssl rand -hex 64)
JWT_SECRET=your-super-secure-jwt-secret-key-minimum-64-characters-long-use-openssl-rand-hex-64
JWT_EXPIRES_IN=24h
JWT_REFRESH_SECRET=your-super-secure-refresh-secret-key-minimum-64-characters-long
JWT_REFRESH_EXPIRES_IN=7d

# Session Configuration
SESSION_SECRET=your-super-secure-session-secret-key-minimum-64-characters-long
SESSION_NAME=pathfinder_session
SESSION_MAX_AGE=86400000
SESSION_SECURE=true
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=strict

# Password Hashing
BCRYPT_ROUNDS=12

# CORS Configuration
CORS_ORIGIN=https://yourdomain.com,https://www.yourdomain.com
CORS_CREDENTIALS=true
CORS_MAX_AGE=86400

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=1000
RATE_LIMIT_LOGIN_MAX=5
RATE_LIMIT_API_MAX=100

# Content Security Policy
CSP_ENABLED=true
CSP_REPORT_ONLY=false

# =============================================================================
# SSL Certificate Configuration
# =============================================================================
SSL_DOMAIN=yourdomain.com
SSL_EMAIL=admin@yourdomain.com
SSL_CERT_PATH=/etc/letsencrypt/live/yourdomain.com/fullchain.pem
SSL_KEY_PATH=/etc/letsencrypt/live/yourdomain.com/privkey.pem

# Let's Encrypt / Certbot
CERTBOT_EMAIL=${SSL_EMAIL}
SSL_AUTO_RENEW=true
SSL_RENEWAL_DAYS=30

# SSL Configuration
SSL_PROTOCOLS=TLSv1.2,TLSv1.3
SSL_CIPHERS=ECDHE+AESGCM:ECDHE+AES256:ECDHE+AES128:!aNULL:!MD5:!DSS

# =============================================================================
# Monitoring & Analytics Configuration
# =============================================================================
# Grafana
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=your-secure-grafana-password-min-32-chars
GRAFANA_SECRET_KEY=your-grafana-secret-key-32-chars-minimum
GRAFANA_PORT=3001
GRAFANA_DOMAIN=grafana.yourdomain.com

# Prometheus
PROMETHEUS_PORT=9090
PROMETHEUS_RETENTION_TIME=30d
PROMETHEUS_STORAGE_SIZE=10GB

# AlertManager
ALERTMANAGER_PORT=9093
ALERTMANAGER_SLACK_WEBHOOK=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK

# Health Check
HEALTH_CHECK_INTERVAL=30000
HEALTH_CHECK_TIMEOUT=5000
HEALTH_CHECK_RETRIES=3

# Logging Configuration
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE_PATH=/var/log/pathfinder/app.log
LOG_MAX_SIZE=100M
LOG_MAX_FILES=10
LOG_ROTATE_INTERVAL=daily

# Application Performance Monitoring
APM_ENABLED=true
APM_SERVICE_NAME=pathfinder-prod
APM_ENVIRONMENT=production

# =============================================================================
# AI Service Configuration
# =============================================================================
# Google Gemini API (Primary)
GEMINI_API_KEY=your-google-gemini-api-key-here
GEMINI_MODEL=gemini-1.5-pro-latest
GEMINI_MAX_TOKENS=8192
GEMINI_TEMPERATURE=0.7
GEMINI_TOP_P=0.8

# OpenAI API (Backup)
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=gpt-4-turbo-preview
OPENAI_MAX_TOKENS=4096
OPENAI_TEMPERATURE=0.7

# AI Service Settings
AI_PRIMARY_PROVIDER=gemini
AI_REQUEST_TIMEOUT=30000
AI_RETRY_ATTEMPTS=3
AI_RATE_LIMIT_PER_HOUR=1000
AI_CACHE_ENABLED=true
AI_CACHE_TTL=3600

# AI Content Filtering
AI_CONTENT_FILTER_ENABLED=true
AI_CONTENT_FILTER_STRICT=false

# =============================================================================
# File Storage Configuration
# =============================================================================
# Local Storage
UPLOAD_PATH=/var/uploads/pathfinder
UPLOAD_MAX_SIZE=104857600
UPLOAD_ALLOWED_TYPES=image/jpeg,image/png,image/gif,image/webp,application/pdf,text/plain
UPLOAD_TEMP_PATH=/tmp/pathfinder-uploads

# AWS S3 (Cloud Storage)
AWS_ACCESS_KEY_ID=your-aws-access-key-id
AWS_SECRET_ACCESS_KEY=your-aws-secret-access-key
AWS_REGION=us-east-1
AWS_S3_BUCKET=pathfinder-prod-storage
AWS_S3_PUBLIC_BUCKET=pathfinder-prod-public
AWS_CLOUDFRONT_DOMAIN=cdn.yourdomain.com

# File Processing
IMAGE_RESIZE_ENABLED=true
IMAGE_RESIZE_QUALITY=85
IMAGE_MAX_WIDTH=2048
IMAGE_MAX_HEIGHT=2048

# CDN Configuration
CDN_URL=https://cdn.yourdomain.com
CDN_CACHE_TTL=86400
CDN_PURGE_ENDPOINT=https://api.cloudflare.com/client/v4/zones/YOUR_ZONE_ID/purge_cache

# =============================================================================
# Backup Configuration
# =============================================================================
# Database Backup
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_PATH=/var/backups/pathfinder
BACKUP_COMPRESSION=gzip

# S3 Backup
BACKUP_S3_ENABLED=true
BACKUP_S3_BUCKET=pathfinder-backups
BACKUP_S3_REGION=us-east-1
BACKUP_S3_ENCRYPTION=AES256

# Backup Encryption
BACKUP_ENCRYPTION_ENABLED=true
BACKUP_ENCRYPTION_KEY=your-backup-encryption-key-32-chars-min

# Backup Monitoring
BACKUP_WEBHOOK_URL=https://yourdomain.com/webhooks/backup-status
BACKUP_SLACK_WEBHOOK=https://hooks.slack.com/services/YOUR/BACKUP/WEBHOOK

# =============================================================================
# Email Service Configuration
# =============================================================================
# SMTP Configuration
SMTP_HOST=smtp.yourdomain.com
SMTP_PORT=587
SMTP_SECURE=true
SMTP_USER=noreply@yourdomain.com
SMTP_PASSWORD=your-smtp-password-or-app-password
SMTP_FROM_NAME=Pathfinder Team
SMTP_FROM_EMAIL=noreply@yourdomain.com

# Email Templates
EMAIL_TEMPLATE_PATH=/app/templates/email
EMAIL_LOGO_URL=https://cdn.yourdomain.com/logo.png

# Email Service Providers (Alternative)
# SendGrid
SENDGRID_API_KEY=your-sendgrid-api-key
# Mailgun
MAILGUN_API_KEY=your-mailgun-api-key
MAILGUN_DOMAIN=yourdomain.com

# Email Queue
EMAIL_QUEUE_ENABLED=true
EMAIL_QUEUE_REDIS_URL=${REDIS_URL}
EMAIL_BATCH_SIZE=10

# =============================================================================
# Performance Optimization
# =============================================================================
# Caching
CACHE_ENABLED=true
CACHE_TTL_DEFAULT=3600
CACHE_TTL_STATIC=86400
CACHE_TTL_API=300
CACHE_TTL_USER_SESSION=1800
CACHE_MAX_SIZE=1073741824

# Compression
COMPRESSION_ENABLED=true
COMPRESSION_LEVEL=6
COMPRESSION_THRESHOLD=1024

# Memory Management
NODE_OPTIONS=--max-old-space-size=4096
NODE_MAX_OLD_SPACE_SIZE=4096
UV_THREADPOOL_SIZE=128

# Connection Pooling
HTTP_KEEP_ALIVE_TIMEOUT=5000
HTTP_HEADERS_TIMEOUT=60000
HTTP_MAX_HEADER_SIZE=16384

# CDN and Static Assets
STATIC_CACHE_MAX_AGE=31536000
STATIC_COMPRESSION=true

# =============================================================================
# Third-party Integrations
# =============================================================================
# Google Analytics
GA_TRACKING_ID=G-XXXXXXXXXX
GA_MEASUREMENT_ID=G-XXXXXXXXXX

# Google Tag Manager
GTM_CONTAINER_ID=GTM-XXXXXXX

# Sentry Error Tracking
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=production
SENTRY_RELEASE=${VERSION}
SENTRY_TRACES_SAMPLE_RATE=0.1

# Mixpanel Analytics
MIXPANEL_TOKEN=your-mixpanel-token

# Intercom Customer Support
INTERCOM_APP_ID=your-intercom-app-id
INTERCOM_SECRET_KEY=your-intercom-secret-key

# Stripe Payment (if applicable)
STRIPE_PUBLISHABLE_KEY=pk_live_your-stripe-publishable-key
STRIPE_SECRET_KEY=sk_live_your-stripe-secret-key
STRIPE_WEBHOOK_SECRET=whsec_your-stripe-webhook-secret

# =============================================================================
# Microservices Configuration (if applicable)
# =============================================================================
# API Gateway
API_GATEWAY_URL=https://api.yourdomain.com
API_VERSION=v1
API_TIMEOUT=30000

# Service Discovery
CONSUL_HOST=consul.yourdomain.com
CONSUL_PORT=8500

# Message Queue (RabbitMQ)
RABBITMQ_URL=amqp://pathfinder:your-rabbitmq-password@rabbitmq:5672/pathfinder
RABBITMQ_MANAGEMENT_URL=http://rabbitmq:15672
RABBITMQ_RETRY_ATTEMPTS=3

# Event Streaming (Apache Kafka)
KAFKA_BROKERS=kafka-1:9092,kafka-2:9092,kafka-3:9092
KAFKA_CLIENT_ID=pathfinder-prod
KAFKA_GROUP_ID=pathfinder-consumers

# =============================================================================
# Container & Orchestration Configuration
# =============================================================================
# Docker Configuration
CONTAINER_NAME=pathfinder-prod
DOCKER_NETWORK=pathfinder-network
DOCKER_RESTART_POLICY=unless-stopped

# Health Check for Containers
HEALTHCHECK_INTERVAL=30s
HEALTHCHECK_TIMEOUT=10s
HEALTHCHECK_RETRIES=3
HEALTHCHECK_START_PERIOD=40s

# Kubernetes (if using)
K8S_NAMESPACE=pathfinder-prod
K8S_SERVICE_ACCOUNT=pathfinder
K8S_CONFIG_MAP=pathfinder-config

# Docker Swarm (if using)
DOCKER_SWARM_NODE_ID=node-1
DOCKER_SWARM_SERVICE_REPLICAS=3

# =============================================================================
# Load Balancer & Scaling Configuration
# =============================================================================
# Load Balancer
LOAD_BALANCER_URL=https://lb.yourdomain.com
LOAD_BALANCER_ALGORITHM=round_robin
STICKY_SESSIONS=true

# Auto Scaling
AUTO_SCALING_ENABLED=true
MIN_INSTANCES=2
MAX_INSTANCES=10
SCALING_CPU_THRESHOLD=70
SCALING_MEMORY_THRESHOLD=80

# PM2 Process Manager
PM2_INSTANCES=max
PM2_MAX_MEMORY=2G
PM2_MIN_UPTIME=10s
PM2_MAX_RESTARTS=3

# =============================================================================
# Security Headers & Policies
# =============================================================================
# Security Headers
SECURITY_HEADERS_ENABLED=true
HELMET_ENABLED=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# Content Security Policy
CSP_DEFAULT_SRC='self'
CSP_SCRIPT_SRC='self' 'unsafe-inline' https://cdn.yourdomain.com
CSP_STYLE_SRC='self' 'unsafe-inline' https://fonts.googleapis.com
CSP_IMG_SRC='self' data: https:
CSP_FONT_SRC='self' https://fonts.gstatic.com

# XSS Protection
XSS_PROTECTION_ENABLED=true
XSS_PROTECTION_MODE=block

# Frame Options
X_FRAME_OPTIONS=DENY

# =============================================================================
# Development & Debug (Production should be disabled)
# =============================================================================
# Debug Configuration
DEBUG_MODE=false
DEBUG_SQL=false
DEBUG_REDIS=false
ENABLE_PROFILER=false

# API Documentation
ENABLE_SWAGGER=false
SWAGGER_URL=/api/docs

# GraphQL Playground
ENABLE_GRAPHQL_PLAYGROUND=false

# Source Maps
GENERATE_SOURCEMAP=false

# =============================================================================
# Timezone & Localization
# =============================================================================
# Timezone
TZ=UTC
TIMEZONE=UTC

# Localization
DEFAULT_LOCALE=en-US
SUPPORTED_LOCALES=en-US,zh-CN,ja-JP,es-ES,fr-FR,de-DE
LOCALE_PATH=/app/locales

# Currency & Region
DEFAULT_CURRENCY=USD
DEFAULT_COUNTRY=US

# =============================================================================
# Custom Application Settings
# =============================================================================
# Feature Flags
FEATURE_AI_ENABLED=true
FEATURE_ANALYTICS_ENABLED=true
FEATURE_FILE_UPLOAD_ENABLED=true
FEATURE_REAL_TIME_ENABLED=true
FEATURE_NOTIFICATIONS_ENABLED=true
FEATURE_COLLABORATION_ENABLED=true

# Business Logic Limits
MAX_USERS_PER_ORGANIZATION=1000
MAX_PROJECTS_PER_USER=100
MAX_NODES_PER_FUNNEL=500
MAX_FUNNELS_PER_PROJECT=50
DATA_RETENTION_DAYS=365

# WebSocket Configuration
WS_ENABLED=true
WS_PORT=3001
WS_HEARTBEAT_INTERVAL=30000
WS_MAX_CONNECTIONS=10000

# Real-time Features
REAL_TIME_ENABLED=true
REAL_TIME_REDIS_URL=${REDIS_URL}

# =============================================================================
# External API Integrations
# =============================================================================
# CRM Integration (Salesforce)
SALESFORCE_CLIENT_ID=your-salesforce-client-id
SALESFORCE_CLIENT_SECRET=your-salesforce-client-secret
SALESFORCE_SANDBOX=false

# Marketing Automation (HubSpot)
HUBSPOT_API_KEY=your-hubspot-api-key
HUBSPOT_PORTAL_ID=your-hubspot-portal-id

# Social Media APIs
TWITTER_API_KEY=your-twitter-api-key
TWITTER_API_SECRET=your-twitter-api-secret
FACEBOOK_APP_ID=your-facebook-app-id
FACEBOOK_APP_SECRET=your-facebook-app-secret

# =============================================================================
# Compliance & Auditing
# =============================================================================
# GDPR Compliance
GDPR_ENABLED=true
GDPR_CONSENT_REQUIRED=true
DATA_RETENTION_POLICY=2y

# Audit Logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_LEVEL=info
AUDIT_LOG_PATH=/var/log/pathfinder/audit.log

# Data Encryption
ENCRYPTION_ALGORITHM=aes-256-gcm
ENCRYPTION_KEY=your-encryption-key-32-bytes-exactly
FIELD_ENCRYPTION_ENABLED=true

# =============================================================================
# Environment Verification Checklist
# =============================================================================
# Security Checklist:
# □ All passwords use strong random strings (min 32 characters)
# □ JWT_SECRET uses secure random key (64+ characters)
# □ Database passwords don't contain special characters
# □ Firewall restricts database and Redis network access
# □ SSL certificates configured for auto-renewal
# □ Backup strategy configured with monitoring alerts
# □ Email service configured and tested
# □ All third-party API keys are production keys
# □ Error monitoring service configured for alerts
# □ Rate limiting configured appropriately
# □ Security headers enabled and configured
# □ Content Security Policy properly configured

# Deployment Verification Checklist:
# □ Access https://${DOMAIN_NAME}/health - check service status
# □ Access https://${DOMAIN_NAME}/api/health - check API status  
# □ Login and test core functionality
# □ Verify SSL certificate validity and rating
# □ Confirm monitoring dashboards collecting data
# □ Test error pages and rate limiting
# □ Verify backup tasks executing properly
# □ Check log file permissions and rotation
# □ Validate database connections and performance
# □ Test AI services and API integrations
# □ Verify file upload and storage functionality
# □ Confirm email delivery works correctly